<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Agent Login | Mumbai Realty</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'DM Sans', sans-serif;
      background: #0b1120;
      min-height: 100vh;
      display: flex; align-items: center; justify-content: center;
      padding: 24px;
    }
    .card {
      background: #fff;
      border-radius: 20px;
      padding: 48px 40px;
      width: 100%; max-width: 420px;
      box-shadow: 0 24px 80px rgba(0,0,0,0.4);
    }
    .logo {
      font-family: 'Cormorant Garamond', serif;
      font-size: 2rem; font-weight: 700;
      color: #0b1120; text-align: center;
      margin-bottom: 6px;
    }
    .logo span { color: #c9a84c; }
    .sub { text-align:center; color:#64748b; font-size:0.85rem; margin-bottom:32px; }
    label {
      display: block;
      font-size: 0.78rem; font-weight: 600;
      color: #64748b; margin-bottom: 8px;
      text-transform: uppercase; letter-spacing: 0.5px;
    }
    .input-wrap { position: relative; margin-bottom: 20px; }
    .input-wrap i.left {
      position: absolute; left: 14px; top: 50%;
      transform: translateY(-50%); color: #94a3b8;
      pointer-events: none;
    }
    input {
      width: 100%;
      padding: 13px 44px;
      border: 1.5px solid #e5e7eb;
      border-radius: 10px;
      font-size: 0.9rem;
      font-family: 'DM Sans', sans-serif;
      background: #f8fafc;
      color: #1e293b;
      transition: border-color 0.2s;
    }
    input:focus { outline: none; border-color: #3b82f6; background: #fff; }
    .eye {
      position: absolute; right: 14px; top: 50%;
      transform: translateY(-50%);
      color: #94a3b8; cursor: pointer;
    }
    .error {
      background: #fef2f2; color: #dc2626;
      border: 1px solid #fecaca;
      padding: 12px 16px; border-radius: 8px;
      font-size: 0.875rem; margin-bottom: 16px;
      display: none;
    }
    .btn-login {
      width: 100%; background: #0b1120; color: #fff;
      border: none; border-radius: 10px;
      padding: 14px; font-weight: 700; font-size: 1rem;
      cursor: pointer; font-family: 'DM Sans', sans-serif;
      transition: background 0.2s; margin-top: 4px;
      display: flex; align-items: center; justify-content: center; gap: 8px;
    }
    .btn-login:hover { background: #1e293b; }
    .btn-login:disabled { opacity: 0.7; cursor: not-allowed; }
    .divider {
      display: flex; align-items: center; gap: 12px;
      color: #94a3b8; font-size: 0.8rem; margin: 20px 0;
    }
    .divider::before, .divider::after { content:''; flex:1; height:1px; background:#e5e7eb; }
    .btn-back {
      display: flex; align-items: center; justify-content: center; gap: 8px;
      width: 100%; background: #f8fafc; color: #1e293b;
      border: 1.5px solid #e5e7eb; border-radius: 10px;
      padding: 12px; font-weight: 600; font-size: 0.9rem;
      text-decoration: none; transition: background 0.2s;
    }
    .btn-back:hover { background: #e5e7eb; color: #1e293b; }
    .note { text-align:center; color:#94a3b8; font-size:0.75rem; margin-top:20px; line-height:1.6; }
    .loader {
      position: fixed; inset: 0; background: #0b1120;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      z-index: 9999; transition: opacity 0.5s;
    }
    .loader.hide { opacity: 0; pointer-events: none; }
    .loader-logo { font-family:'Cormorant Garamond',serif; font-size:2rem; font-weight:700; color:#fff; margin-bottom:20px; }
    .loader-logo span { color:#c9a84c; }
    .loader-bar { width:140px; height:3px; background:rgba(255,255,255,0.15); border-radius:3px; overflow:hidden; }
    .loader-fill { height:100%; background:#c9a84c; animation: fill 0.9s ease forwards; }
    @keyframes fill { from{width:0} to{width:100%} }
    @keyframes spin { to { transform: rotate(360deg); } }
    .fa-spin { animation: spin 0.8s linear infinite; }
  </style>
</head>
<body>

<div class="loader" id="loader">
  <div class="loader-logo">Mumbai<span>Realty</span></div>
  <div class="loader-bar"><div class="loader-fill"></div></div>
</div>

<div class="card">
  <div class="logo">Mumbai<span>Realty</span></div>
  <p class="sub">Agent Portal — Authorized Access Only</p>

  <div class="error" id="errBox"></div>

  <form id="loginForm" novalidate>
    <label>Email Address</label>
    <div class="input-wrap">
      <i class="fas fa-envelope left"></i>
      <input type="email" id="email" placeholder="agent@example.com" autocomplete="email"/>
    </div>

    <label>Password</label>
    <div class="input-wrap">
      <i class="fas fa-lock left"></i>
      <input type="password" id="password" placeholder="Enter your password" autocomplete="current-password"/>
      <i class="fas fa-eye eye" id="eyeIcon" onclick="toggleEye()"></i>
    </div>

    <button type="submit" class="btn-login" id="loginBtn">
      <i class="fas fa-sign-in-alt"></i> Login to Dashboard
    </button>
  </form>

  <div class="divider">secure agent portal</div>

  <a href="index.html" class="btn-back">
    <i class="fas fa-arrow-left"></i> Back to Website
  </a>

  <p class="note">Public registration is disabled.<br>Contact admin for access.</p>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script>
  const AGENT_EMAIL = "craftnixdigital@gmail.com";

  if (!firebase.apps.length) {
    firebase.initializeApp({
      apiKey: "AIzaSyAfbx0WlUPJ0elur2l09GXZfi0j2jVoGuM",
      authDomain: "mumbai-realty.firebaseapp.com",
      projectId: "mumbai-realty",
      storageBucket: "mumbai-realty.firebasestorage.app",
      messagingSenderId: "806144133947",
      appId: "1:806144133947:web:541f7a32084f815da7c51e"
    });
  }
  const auth = firebase.auth();

  setTimeout(() => {
    const l = document.getElementById('loader');
    l.classList.add('hide');
    setTimeout(() => l.remove(), 500);
  }, 900);

  auth.onAuthStateChanged(user => {
    if (user && user.email === AGENT_EMAIL) window.location.href = 'dashboard.html';
  });

  document.getElementById('loginForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    const email = document.getElementById('email').value.trim();
    const pass  = document.getElementById('password').value;
    const btn   = document.getElementById('loginBtn');
    const err   = document.getElementById('errBox');

    err.style.display = 'none';

    if (!email || !pass) {
      err.textContent = 'Email aur password dono daalen.';
      err.style.display = 'block'; return;
    }

    if (email.toLowerCase() !== AGENT_EMAIL.toLowerCase()) {
      err.textContent = 'Access denied. Sirf authorized agent login kar sakta hai.';
      err.style.display = 'block'; return;
    }

    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Logging in…';

    try {
      await auth.signInWithEmailAndPassword(email, pass);
      window.location.href = 'dashboard.html';
    } catch (ex) {
      console.error('Firebase error:', ex.code, ex.message);
      let msg = ex.message;
      if (ex.code === 'auth/wrong-password' || ex.code === 'auth/invalid-credential') msg = 'Password galat hai. Dobara try karein.';
      else if (ex.code === 'auth/user-not-found') msg = 'Yeh email register nahi hai.';
      else if (ex.code === 'auth/too-many-requests') msg = 'Bahut zyada attempts. Thodi der baad try karein.';
      else if (ex.code === 'auth/network-request-failed') msg = 'Network error. Internet check karein.';
      err.textContent = msg;
      err.style.display = 'block';
    } finally {
      btn.disabled = false;
      btn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login to Dashboard';
    }
  });

  function toggleEye() {
    const inp = document.getElementById('password');
    const ico = document.getElementById('eyeIcon');
    if (inp.type === 'password') { inp.type = 'text'; ico.className = 'fas fa-eye-slash eye'; }
    else { inp.type = 'password'; ico.className = 'fas fa-eye eye'; }
  }
</script>
</body>
</html>